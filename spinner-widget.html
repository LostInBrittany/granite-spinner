<!--
    @license MIT
    Copyright (c) 2015 Horacio "LostInBrittany" Gonzalez

    Relative paths assume component is being run from inside an app or another component, where dependencies are flat
    siblings. When this component is run from its own repo (e.g. ui tests, examples), we assume the server is started with
    'polyserve' (or similar server setup) to enable correct finding of bower dependencies for local runs
    See https://github.com/PolymerLabs/polyserve
-->
<link rel="import" href="../polymer/polymer.html"/>


<!--
Spinner-Widget is a simple,lightweight Polymer web component component used to indicate when data is being loaded, a view is changing,
or any place a visual indication is needed to show that work is being done for an indefinite period of time.

##### Usage
    <spinner-widget></spinner-widget>
@element spinner-widget
@blurb Element providing an indication of data or a view loading.
@homepage index.html
@demo demo.html
-->
<dom-module id="spinner-widget">
  <link rel="import" type="css" href="spinner-widget.css"/>
  <template>
      <div id="spinner-container">
        <div id="spinner" class='loading'>
        </div>
      </div>
  </template>
</dom-module>

<script>
Polymer({
  is: 'spinner-widget',
  properties: {
    active: {
      type: Boolean,
      value: false,
      reflectToAttribute: true,
    },
    hover: {
      type: Boolean,
      value: false,
      reflectToAttribute: true,
    },
    size: {
      type: Number,
      value: 100,
      notify:true
    },
    color: {
      type: String,
      value: "#28b6d8"
    },
    lineWidth: {
      type: String,
      value: "1.5em",
      notify:true
    },
    containerHeight: {
      type: Number,
      value: 150
    },
    _shown:{
      type:String,
      computed: "_isShown(active,isAttached)"
    },
  },
  ready: function () {
  },
  attached: function () {
    console.debug("[spinner-widget] attached - size", this.size)
    this.$.spinner.style.width = this.size+'px';
    this.$.spinner.style.height = this.size+'px';
    this.$.spinner.style.borderLeftColor = this.color;
    this.$.spinner.style.borderWidth = this.lineWidth;
    if (this.hover) {
      this.$$("#spinner-container").style.position = "absolute";
    } else {
      this.$$("#spinner-container").style.position = "relative";
    }
    this.$$("#spinner-container").style.minWidth = this.size+'px';
    this.$$("#spinner-container").style.minHeight = this.size+'px';
    this.$$("#spinner-container").style.height = Math.max(this.size, this.containerHeight) +'px';
    this.isAttached = true;
  },
  _isShown: function () {
    // _isShown() is the control function of styleSpinner property,
    // a computed property based on active and isAttached
    // We need to varify that the component is attached (or at least ready)
    // and then, if shown attribute is present, we display the spinner
    // console.debug("[spinner-widget] _isShown - active: %s, isAttached: %s", this.active, this.isAttached);
    if (this.isAttached && this.active) {
      this.$$("#spinner-container").style.display = "flex";
    } else {
      this.$$("#spinner-container").style.display = "none";
    }
  }
})
</script>
